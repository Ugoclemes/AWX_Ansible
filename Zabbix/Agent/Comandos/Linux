Apenas linhas não comentadas

| grep -Ev '[:blank]*#|^[:blank]*$'

***********************************************************************
Comando para consultar zabbix - CollectStation

zabbix_get -s 201.91.2.207 -p 10059 -k scan.channels

***********************************************************************
SNMP

snmpwalk -v 1 -c 1nfr@s3crouter 201.73.213.162

snmpwalk -v3 -l authPriv -u monitor -a SHA -A "monitor" -x AES -X "monitor" 10.161.20.200

*************************************************************************

HAPROXY - Alterar banco principal

nano /etc/haproxy/haproxy.cfg

Reiniciar o Servi�o - /etc/init.d/haproxy restart

*************************************************************************
MySQL

Alterar numero de conex�es do Mysql

SET GLOBAL max_connections = 200;

Verificar conex�es no banco

show status like 'Conn%';

Verificar as configura��es do MYSql e aponta melhorias

./tuning-primer.sh

*************************************************************************
Telegram

Name: Kantaribope
Bot: Kantaribopebot
ID: 206376555:AAEb9FQWQ4fevKl_Z_C8fpaipsQRUtUk90U


https://api.telegram.org/bot206376555:AAEb9FQWQ4fevKl_Z_C8fpaipsQRUtUk90U/getUpdates

https://api.telegram.org/bot517793255:AAHRAdEM5S_VJNDchOhNxk4lmNi-eTJwPJA/getUpdates - STF_Zabbix

145354530:AAGhlRGF51oq4FtiSOrOigugFj0JzPgQnRg

Ugo ID: 204811825
Carina ID: 275511244
Marco ID: 355831869

ID 577938884 - William Toledo
ID 573864790 - Marcelo Oliveira
ID -284042081 - Grupo Redes
ID -397489903 - Grupo Redes Orbitall
ID -378630855 - STF - ADM Local


https://outlook.office.com/webhook/30130042-4dfb-47c6-8930-0d50a8a0a5cf@d8bde65a-3ded-4346-9518-670204e6e184/IncomingWebhook/3aca0ffe40ce4d57a716ceb58703f5e6/8fb4975f-f365-4838-9056-9f4f5b409e4a

************************************************************************
Atualiza��o Python

wget https://www.python.org/ftp/python/3.0/Python-3.0.tgz
tar -xzf Python-3.5.1.tgz
cd Python-3.5.1

./configure --prefix=/usr --enable-shared
make
sudo make install
cd ..

sudo update-alternatives --install /usr/bin/python python /usr/bin/python2.6 20
sudo update-alternatives --install /usr/bin/python python /usr/bin/python2.7 10
sudo update-alternatives --install /usr/bin/python python /usr/bin/python3.5 0

sudo update-alternatives --set python /usr/bin/python2.6


***********************************************************************

Adicionar trafego de interface no mapa

Network
IN: {CS_55_465_202:net.if.in[eth0].last(0)}
OUT: {CS_55_465_202:net.if.out[eth0].last(0)}

Network
IN: {ROUTER ISR BEL - CS3:ifHCInOctets[GigabitEthernet0].last(0)}
OUT: {ROUTER ISR BEL - CS3:ifHCOutOctets[GigabitEthernet0].last(0)}

***********************************************************************************************

runas /user:domain\username cmd.exe

C:\Windows\SysWOW64

******************************************************************************************
Aumento de memoria CacheSize

sysctl -a | grep -E "shmall|shmmax"

nano /etc/sysctl.conf

Adicionar ou aumentar a linha
kernel.shmmax = 134217728
268435456

Comando para atualizar o arquivo
sysctl -p

**********************************************************************************************
Banco de Dados n�o sincroniza

DB com problema

/home/mysql - mover para .old
	- mv mysql/ mysql.old

Criar uma nova pasta e premiss�o:
	mkdir mysql
	chown -R mysql:mysql mysql

DB Operacional

Parar o servi�o do mysql

Copiar os arquivos /home/mysql
 	scp -r mysql/* root@172.16.12.36:/home/mysql/


Iniciar o servi�o do mysql

DB com problema
Verificar as permiss�o dos arquivos no /home/mysql/
	chown -R mysql:mysql *

Iniciar o servi�o do mysql

Acessar o banco
	show status like 'wsrep%';

Verificar se esta sincronizando:
	 wsrep_incoming_addresses     | 172.16.12.36:3306,172.16.12.34:3306,172.16.12.35:3306 

Apagar arquivos bin

PURGE BINARY LOGS TO 'soalv3clzabdb01-bin.000097
	
*************************************************************************************************
IP Publico 

curl ifconfig.me


**************************************************************************************************

Logs - /var/log/messages

AllowRoot=1
MaxLinesPerSecond=2
HostMetadata=CollectStation

#c0ll3ct#

vi /usr/local/etc/zabbix_agentd.conf

X o valor do tempo de coleta.

se o tempo de verifica��o do for 10min o log ira trazer 600x5= 3000 linhas a cada 10 minutos.


***************************************************************************************************

UserParameter=query.sql[*],"C:\Program Files\Microsoft SQL Server\110\Tools\Binn\sqlcmd.exe" -U usr_noc_smart -P #noc@smart# -S 127.0.0.1\TCNetBR,1440 -Q "SET NOCOUNT ON SELECT TOP 1 $1 [ ] FROM TCWEB.DBO.TC_AUDIENCIA WHERE PRACA_ID='$2'AND AUD_BASE<>'0'ORDER BY AUD_DATA DESC"


***************************************************************************************************************
Pacotes baixados pelo APT-GET

/var/cache/apt/archives

cat /etc/debian_version

HostMetadata=CaptureSite


*******************************************************************************************************************

Syslog-ng

/etc/syslog-ng/syslog-ng.conf

##Source
source log_bigip { udp();};

##Filter
filter f_nexus1 { netmask(10.255.254.1); };

##Destination
destination d_nexus1 { file("/var/log/nexus1.log"); };

##Log
log { source(log_bigip); filter(f_nexus1); destination(d_nexus1); };

@include "/etc/syslog-ng/conf.d/*.conf"

***********************************************************************************************************************


 ipmitool -I lanplus -H 172.17.1.86 -U root
 
 ./configure --with-openssl 
 
cd /tmp
apt-get source openipmi
cd openipmi-2*
edit file debian/rules
find ./configure in section "config.status:"
  CFLAGS="$(CFLAGS)" ./configure --host=$(DEB_HOST_GNU_TYPE) \
rename for --with-openssl to ./configure:
save file
dpkg-buildpackage
cd ..
dpkg -i openipmi*.deb libopenipmi*.deb
restart zabbix server


ipmi-sensors -D LAN2_0 -h 192.168.15.107 -u administrator -p N68RRQD8 -l USER -W discretereading


************************************************************************************************************************
Instala��o ODBC Mysql

http://www.unixodbc.org/download.html

https://dev.mysql.com/downloads/connector/odbc/

apt-get install unixodbc libmyodbc unixodbc-dev

odbcinst -j
Caminho dos arquivos de configura��o

isql -v "BANCO" - teste de comunica��o

./configure --with-iodbc --with-unixodbc

********************************************************************************************************************************

grant SELECT on MATCH_STATION_SEARCH.* to pluginZabbix@172.16.12.10 identified by '#pluginS3rv1c3#';

*********************************************************************************************************************************

zabbix_sender -z localhost -s HOST -k ITEM -o "VALOR" 


********************************************************************************************************************************

Recontrir regedit

cd C:\Windows\System32

lodctr /R

********************************************************************************************************************************

Os 3 bancos fora o primeiro iniciar

/etc/init.d/mysql bootstrap-pxc

********************************************************************************************************************************

netsh firewall set portopening TCP 10050 zabbix_agent
netsh firewall set icmpsetting 8

*********************************************************************************************************************************
Conex�o SSH

Acessar Proxy

Logar com usuario zabbix

Testar se a conex�o ssh est� pedindo senha

ssh ibope@200.160.247.106

Caso sim

ssh-copy-id ibope@200.160.247.106

Testar novamente se esta pedindo senha

ssh ibope@200.160.247.106 

********************************************************************************************************************************

Configura��o Apache

vi /etc/apache2/sites-available/000-default.conf 

********************************************************************************************************************************

Comandos MySQL

SELECT User, Host FROM mysql.user;

grant all privileges on *.* to 'root'@'%' identified by '$tef@nini1987T&T';

grant all privileges on *.* to 'grafana'@'%' identified by '$Gr@f@n@2019';

Vers�o mais nova do Mysql - para acesso remoto;

GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' WITH GRANT OPTION;

ALTER USER zabbix IDENTIFIED WITH mysql_native_password BY '@rhbYrU1fBJDs';

*******************************************************************************************************************************

Monitorando DNS

host www.globo.com | grep "not found" | wc -l


*******************************************************************************************************************************

Console-kit

ls -l /usr/share/dbus-1/system-services/org.freedesktop.ConsoleKit.service
mv /usr/share/dbus-1/system-services/org.freedesktop.ConsoleKit.service /root/

*********************************************************************************************************************************

RTM - Docker

/home/rtm/zabbix-agent
nano .env_agent
docker-compose -f docker-compose_agent.yaml down
docker-compose -f docker-compose_agent.yaml up -d

Acesso ao Docker
docker-compose -f docker-compose_agent.yaml exec zabbix-agent /bin/bash


***********************************************************************************************************************************
Adicionar parti��o sem reiniciar

ls -ltr /sys/class/scsi_host

Execute o comando (trocando hostX por um dos hosts listados co comando anterior) abaixo para scanear o disco e mapear as unidades /dev/sdX:

echo "- - -" > /sys/class/scsi_host/host2/scan

Extended LVM

fdisk -l
pvcreate /dev/sdd
vgdisplay -s
lvdisplay
vgdisplay -s
vgextend vg00 /dev/sdd
vgdisplay -s
df -h
pvdisplay -s
lvdisplay
lvextend -L +100.00G /dev/vg00/lvmysql
lvextend -l +100%FREE /dev/debian_vg/home
resize2fs /dev/vg00/lvmysql

Caso não assumir o tamnho
xfs_growfs /dev/centos/root 

Create LVM

fdisk -l
pvcreate /dev/sdb
vgcreate debian_vg1 /dev/sdb
mkdir /home2
lvcreate -n home2 -l +100%FREE debian_vg1
mkfs.ext4 /dev/debian_vg1/home2
mount /dev/debian_vg1/home2 /home2

/etc/fstab
acrecentar para montar no boot


************************************************************************************************************************************

Pesquisar Repositorio CENTOS

rpm -qa |grep -i

Remover

rpm -e repositorio

***********************************************************************************************************************************

Configuracao frontend CentOS

nano /etc/zabbix/web/zabbix.conf.php

***********************************************************************************************************************************

Alterar placa de rede CentOS

vi /etc/udev/rules.d/70-persistent-net.rules

***********************************************************************************************************************************

Verificar modelo do Servidor - Windows

wmic csproduct get name

***********************************************************************************************************************************

 cd /usr/share/zabbix/include/
 ls -lart services*
 cp -pr services.inc.php services.inc.php.13082018

tail -f /var/www/html/zabbix_erro.log

nano /etc/httpd/conf.d/zabbix.conf
rpm -e --nodeps zabbix-web-3.4.8-1.el7.noarch
rpm -ivh --nodeps http://repo.zabbix.com/zabbix/3.4/rhel/7/x86_64/zabbix-web-3.4.8-1.el7.noarch.rpm
nano /etc/httpd/conf.d/zabbix.conf
systemctl restart httpd
tail -f /var/www/html/zabbix_erro.log

************************************************************************************************************************************

Renovar Certificado

openssl pkcs12 -in star_stefanini_com_br.pfx -clcerts -nokeys -out zabbix.stefanini.com.br.crt 

openssl pkcs12 -in star_stefanini_com_br.pfx -nocerts -nodes -out zabbix.stefanini.com.br.key 

***********************************************************************************************************************************

Tamanho de arquivo e pasta

du -h --max-depth=1

************************************************************************************************************************************

Samba - CentOS
yum install samba samba-winbind samba-client samba-winbind-clients
mv smb.conf smb.conf.bkp
[global]
        client signing = yes
        client use spnego =yes
        idmap uid = 10000-20000
        winbind refresh tickets = yes
        winbind enum users = yes
        winbind gid = 10000-20000
        winbind use default domain = True
        winbind offline logon = True
        dedicated keytab file = /etc/krb5.keytab
        kerberos method = secrets and keytab
        log file = /var/log/samba/%m.log
        password server = STEFANINI.DOM
        security = ads
        WORKGROUP = STEFANINI-DOM
        realm = STEFANINI.DOM
        printing = cups
        printcap name = cups
        load printers = yes
        cups options = raw
        case sensitive = yes
        #default case = upper
        preserve case = yes
        short preserve case = yes
        #mangle case = yes
        mangled names = no
        mangling method = hash2
[dados]
        comment = Repositorio Veeam SLP
        path = /dados/vr_slp
        valid users = @vcenter_admins
        inherit acls = yes
        inherit permissions = yes
        create mask = 700
        directory mask = 700
        browseable = yes
        read only = no
        guest ok = yes
        veto files = /Thumbs.db/.DS_Store/._.DS_Store/.apdisk/

yum install krb*
# Configuration snippets may be placed in this directory as well
includedir /etc/krb5.conf.d/

[logging]
 default = FILE:/var/log/krb5libs.log
 kdc = FILE:/var/log/krb5kdc.log
 admin_server = FILE:/var/log/kadmind.log

[libdefaults]
# dns_lookup_realm = false
# ticket_lifetime = 24h
# renew_lifetime = 7d
# forwardable = true
# rdns = false
# pkinit_anchors = /etc/pki/tls/certs/ca-bundle.crt
 default_realm = STEFANINI.DOM
# default_ccache_name = KEYRING:persistent:%{uid}

[realms]
 STEFANINI.DOM = {
        }
#  kdc = kerberos.example.com
#  admin_server = kerberos.example.com
# }

[domain_realm]
 .stefanini.dom = STEFANINI.DOM
 stefanini.dom = STEFANINI.DOM


systemctl start smb
systemctl enable smb
systemctl start windind
systemctl start winbind
systemctl enable winbind
net ads join -S soasanad01 -U adminucguedes
net ads keytab create -U adminucguedes

nano /etc/nsswitch.conf

passwd:     files sss winbind
shadow:     files sss winbind
group:      files sss winbind


************************************************************************************
pip3 install --upgrade virtualenv
yum install krb5-devel krb5-libs krb5-workstation gcc
yum install krb5-user
git clone  http://nzqatestrepo.kiwiplan.co.nz/gitlab/kiwicloud/kiwi.cloud.web.git
pip3 install pywinrm[kerberos]
nano /etc/krb5.conf

   
   kinit adminucguedes
   67  klist

   
# To opt out of the system crypto-policies configuration of krb5, remove the
# symlink at /etc/krb5.conf.d/crypto-policies which will not be recreated.
includedir /etc/krb5.conf.d/

[logging]
    default = FILE:/var/log/krb5libs.log
    kdc = FILE:/var/log/krb5kdc.log
    admin_server = FILE:/var/log/kadmind.log

[libdefaults]
    dns_lookup_realm = false
    dns_lookup_kdc = false
    ticket_lifetime = 24h
    renew_lifetime = 7d
    forwardable = true
    rdns = false
    pkinit_anchors = FILE:/etc/pki/tls/certs/ca-bundle.crt
#    spake_preauth_groups = edwards25519
    default_realm = STEFANINI.DOM
#    default_ccache_name = KEYRING:persistent:%{uid}

[realms]
 STEFANINI.DOM = {
     kdc = SOALV3AD02.STEFANINI.DOM
     admin_server = SOALV3AD02.STEFANINI.DOM
 }

[domain_realm]
 .stefanini.dom = STEFANINI.DOM
 stefanini.dom = STEFANINI.DOM


